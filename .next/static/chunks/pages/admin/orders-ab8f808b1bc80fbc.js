(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[426],{2479:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/orders",function(){return t(178)}])},9595:function(e,s){"use strict";s.Z={src:"/_next/static/media/tide.f7ee2ce8.png",height:225,width:225,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAWlBMVEX///////7///3+//////z///v///r//v7+/v/+/v7+/f39/f79/Pz8/P35+vz4+Pr18e7/7Nzr6ODe4Onh3uPb3Ofh2t/g09XD2t/a08XT0NjR0NnQzNaz1uFXaTgPAAAAPklEQVR42hXHxxGAMBAEwYETcIv3XvmnqVL/GiGgMBDqO29wEe85l3J9FloYtvM6RkD7+/0TiFBXAYHMzEUCTRUCNAkNPUEAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8}},8755:function(e,s,t){"use strict";t.d(s,{Z:function(){return Layout}});var i=t(5893),a=t(7294),r=t(1664),n=t.n(r),d=t(1352),l=t(7232),c=t(5675),o=t.n(c),x=t(9595);function Header(e){let{title:s="Tidee Services"}=e,[t,r]=(0,a.useState)(!1);return(0,i.jsxs)("header",{className:"bg-white border-b shadow-sm sticky top-0 z-50",children:[(0,i.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-3 flex items-center justify-between",children:[(0,i.jsx)("div",{className:"flex items-center gap-2",children:(0,i.jsxs)(n(),{href:"/",className:"flex items-center gap-2",children:[(0,i.jsx)(o(),{src:x.Z,alt:"Tidee Services Logo",className:"w-8 h-8 rounded-full"}),(0,i.jsx)("span",{className:"text-lg font-semibold text-indigo-700 tracking-wide",children:"Tidee Services Noida"})]})}),(0,i.jsxs)("nav",{className:"hidden md:flex items-center gap-6 text-sm font-medium",children:[(0,i.jsx)(n(),{href:"/",className:"text-gray-700 hover:text-indigo-600",children:"Home"}),(0,i.jsx)(n(),{href:"/services",className:"text-gray-700 hover:text-indigo-600",children:"Services"}),(0,i.jsx)(n(),{href:"/about",className:"text-gray-700 hover:text-indigo-600",children:"About"}),(0,i.jsx)(n(),{href:"/contact",className:"text-gray-700 hover:text-indigo-600",children:"Contact"}),(0,i.jsx)(n(),{href:"/delivery",className:"text-indigo-600 border border-indigo-600 px-3 py-1.5 rounded-md hover:bg-indigo-600 hover:text-white transition",children:"Delevery"})]}),(0,i.jsx)("button",{onClick:()=>r(!t),className:"md:hidden p-2 rounded-lg hover:bg-gray-100 transition","aria-label":"Toggle menu",children:t?(0,i.jsx)(d.Z,{size:22}):(0,i.jsx)(l.Z,{size:22})})]}),t&&(0,i.jsx)("div",{className:"md:hidden border-t bg-white",children:(0,i.jsxs)("nav",{className:"flex flex-col space-y-2 p-4 text-sm",children:[(0,i.jsx)(n(),{href:"/",className:"block py-2 text-gray-700 hover:text-indigo-600",onClick:()=>r(!1),children:"Home"}),(0,i.jsx)(n(),{href:"/services",className:"block py-2 text-gray-700 hover:text-indigo-600",onClick:()=>r(!1),children:"Services"}),(0,i.jsx)(n(),{href:"/pricing",className:"block py-2 text-gray-700 hover:text-indigo-600",onClick:()=>r(!1),children:"Pricing"}),(0,i.jsx)(n(),{href:"/about",className:"block py-2 text-gray-700 hover:text-indigo-600",onClick:()=>r(!1),children:"About"}),(0,i.jsx)(n(),{href:"/contact",className:"block py-2 text-gray-700 hover:text-indigo-600",onClick:()=>r(!1),children:"Contact"})]})})]})}function Layout(e){let{children:s,title:t}=e;return(0,i.jsxs)("div",{className:"",children:[(0,i.jsx)(Header,{title:t}),(0,i.jsx)("main",{children:s})]})}},178:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return AdminOrders}});var i=t(5893),a=t(7294),r=t(8755);function AdminOrders(){let[e,s]=(0,a.useState)([]),[t,n]=(0,a.useState)([]),[d,l]=(0,a.useState)(!0),[c,o]=(0,a.useState)({});async function fetchOrders(){l(!0);let e=await fetch("/api/orders",{cache:"no-store"});e.ok?s(await e.json()):console.error("Failed to load orders",await e.text()),l(!1)}async function fetchDeliveryPartners(){let e=await fetch("/api/delivery",{cache:"no-store"});e.ok?n(await e.json()):console.error("Failed to load delivery partners",await e.text())}async function assignToPartner(t,i){o(e=>({...e,[t]:!0})),s(e=>e.map(e=>e._id===t?{...e,assignedTo:i,status:i?"assigned":e.status}:e));try{let e=await fetch("/api/orders",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t,action:"assign",assignedTo:i})});if(!e.ok){let s=await e.text();throw Error(s||"Failed to assign")}let a=await e.json();s(e=>e.map(e=>e._id===t?a:e))}catch(t){s(e),alert("Assign failed: "+((null==t?void 0:t.message)||"unknown"))}finally{o(e=>({...e,[t]:!1}))}}return(0,a.useEffect)(()=>{fetchOrders(),fetchDeliveryPartners();let e=setInterval(fetchOrders,1e4);return()=>clearInterval(e)},[]),(0,i.jsxs)(r.Z,{title:"Admin • Orders",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("h2",{className:"text-lg font-semibold",children:"Orders"}),(0,i.jsx)("div",{children:(0,i.jsx)("button",{onClick:fetchOrders,className:"px-3 py-1 bg-indigo-600 text-white rounded",children:"Refresh"})})]}),(0,i.jsxs)("div",{className:"mt-4",children:[d&&(0,i.jsx)("div",{className:"text-center py-6",children:"Loading…"}),!d&&0===e.length&&(0,i.jsx)("div",{className:"text-center text-gray-500",children:"No orders"}),!d&&e.map(e=>{var s,a;return(0,i.jsx)("div",{className:"bg-white p-3 rounded shadow mb-3",children:(0,i.jsxs)("div",{className:"flex flex-col md:flex-row md:justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"font-medium",children:[e.customerName," ",(0,i.jsxs)("span",{className:"text-xs text-gray-500",children:["(",e.phone,")"]})]}),(0,i.jsx)("div",{className:"text-xs text-gray-500",children:e.address}),(0,i.jsxs)("div",{className:"text-xs mt-2",children:["Items: ",null===(s=e.items)||void 0===s?void 0:s.join(", ")]}),(0,i.jsxs)("div",{className:"text-xs text-gray-400 mt-1",children:["Order ID: ",e._id]})]}),(0,i.jsxs)("div",{className:"mt-3 md:mt-0 flex items-center gap-3",children:[(0,i.jsxs)("div",{className:"text-sm",children:[(0,i.jsx)("div",{className:"text-xs text-gray-500",children:"Status"}),(0,i.jsx)("div",{className:"font-semibold",children:e.status})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text-xs text-gray-500 block mb-1",children:"Assign to"}),(0,i.jsxs)("select",{value:null!==(a=e.assignedTo)&&void 0!==a?a:"",onChange:s=>{let t=s.target.value||null;assignToPartner(e._id,t)},disabled:c[e._id],className:"border px-2 py-1 rounded",children:[(0,i.jsx)("option",{value:"",children:"— Unassigned —"}),t.map(e=>(0,i.jsxs)("option",{value:e._id,children:[e.name," ",e.vehicle?"(".concat(e.vehicle,")"):""]},e._id))]})]})]})]})},e._id)})]})]})}}},function(e){e.O(0,[664,763,774,888,179],function(){return e(e.s=2479)}),_N_E=e.O()}]);